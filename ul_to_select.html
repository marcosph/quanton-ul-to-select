<!DOCTYPE html>
<html>
    <head>
        <title>jQuery Piu/Meno Text</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="favicon.ico" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <style>
            div.ul-selector {
                width: auto;
                margin-top: 1rem;
                border: 1px solid #ccc;
                background-image: url("./down-arrow-black.png");
                background-size: 16px 16px;
                background-repeat: no-repeat;
                background-attachment: scroll;
                background-position: calc(100% - 8px) 8px;
                background-color: transparent;
                cursor: pointer;
                line-height: 2rem;
                font-family: sans-serif;
            }
            div.ul-selector-search {
                border-right: 1px solid #ccc;
                border-left: 1px solid #ccc;
            }
            div.ul-selector-search input {
                width: calc(100% - 0.8rem - 2px);
                padding: 0.2rem;
                margin: 0.2rem;
                border: 1px solid #ccc;
                background-image: url("./search.png");
                background-size: 16px 16px;
                background-repeat: no-repeat;
                background-attachment: scroll;
                background-position: calc(100% - 8px) 8px;
                background-color: transparent;
                line-height: 1.6rem;
                font-family: sans-serif;
                font-size: 1rem;
            }
            div.ul-selector a {
                margin-left: 8px;
                padding-left: 8px;
                margin-right: 8px;
                display: block;
                color: #000;
                text-decoration:none;
            }
            ul.ul-select { 
                width: auto;
                margin: 0 auto auto auto;
                padding: 0px;
                border-top: none;
                list-style:none;
                cursor: pointer;
                line-height: 2rem;
                font-family: sans-serif;
                max-height: 300px;
                overflow-x: hidden;
                overflow-y: auto;
            }
            ul.ul-select li.hover {
                background-color: #666;
            }
            ul.ul-select li.hover a {
                color: #fff;
            }
            ul.ul-select li a {
                margin-left: 8px;
                padding-left: 8px;
                margin-right: 8px;
                display: block;
                color: #888;
                text-decoration:none;
            }
            ul.ul-select li:active, ul.ul-select li:hover {
                background-color: #666;
            }
            ul.ul-select li:active a, ul.ul-select li:hover a {
                color: #fff;
            }
        </style>
    </head>
    <body>
        <h2>EUROPE States</h2>
        <ul id="eu">
            <li><a href="#BE">Belgium</a></li>
            <li><a href="#EL">Greece</a></li>
            <li><a href="#LT">Lithuania</a></li>
            <li><a href="#PT">Portugal</a></li>
            <li><a href="#BG">Bulgaria</a></li>
            <li><a href="#ES">Spain</a></li>
            <li><a href="#LU">Luxembourg</a></li>
            <li><a href="#RO">Romania</a></li>
            <li><a href="#CZ">Czech Republic</a></li>
            <li class="active"><a href="#FR">France</a></li>
            <li><a href="#HU">Hungary</a></li>
            <li><a href="#SI">Slovenia</a></li>
            <li><a href="#DK">Denmark</a></li>
            <li><a href="#HR">Croatia</a></li>
            <li><a href="#MT">Malta</a></li>
            <li><a href="#SK">Slovakia</a></li>
            <li><a href="#DE">Germany</a></li>
            <li><a href="#IT">Italy</a></li>
            <li><a href="#NL">Netherlands</a></li>
            <li><a href="#FI">Finland</a></li>
            <li><a href="#EE">Estonia</a></li>
            <li><a href="#CY">Cyprus</a></li>
            <li><a href="#AT">Austria</a></li>
            <li><a href="#SE">Sweden</a></li>
            <li><a href="#IE">Ireland</a></li>
            <li><a href="#LV">Latvia</a></li>
            <li><a href="#PL">Poland</a></li>
            <li><a href="#UK">United Kingdom</a></li>
        </ul>
        <h2>USA States</h2>
        <ul id="usa">
            <li><a href="#AL">Alabama</a></li>
            <li><a href="#AK">Alaska</a></li>
            <li><a href="#AZ">Arizona</a></li>
            <li><a href="#AR">Arkansas</a></li>
            <li><a href="#CA">California</a></li>
            <li><a href="#CO">Colorado</a></li>
            <li><a href="#CT">Connecticut</a></li>
            <li><a href="#DE">Delaware</a></li>
            <li><a href="#FL">Florida</a></li>
            <li><a href="#GA">Georgia</a></li>
            <li><a href="#HI">Hawaii</a></li>
            <li><a href="#ID">Idaho</a></li>
            <li><a href="#IL">Illinois</a></li>
            <li><a href="#IN">Indiana</a></li>
            <li><a href="#IA">Iowa</a></li>
            <li><a href="#KS">Kansas</a></li>
            <li><a href="#KY">Kentucky</a></li>
            <li><a href="#LA">Louisiana</a></li>
            <li><a href="#ME">Maine</a></li>
            <li><a href="#MD">Maryland</a></li>
            <li><a href="#MA">Massachusetts</a></li>
            <li><a href="#MI">Michigan</a></li>
            <li><a href="#MN">Minnesota</a></li>
            <li><a href="#MS">Mississippi</a></li>
            <li><a href="#MO">Missouri</a></li>
            <li><a href="#MT">Montana</a></li>
            <li><a href="#NE">Nebraska</a></li>
            <li><a href="#NV">Nevada</a></li>
            <li><a href="#NH">New Hampshire</a></li>
            <li><a href="#NJ">New Jersey</a></li>
            <li><a href="#NM">New Mexico</a></li>
            <li><a href="#NY">New York</a></li>
            <li><a href="#NC">North Carolina</a></li>
            <li><a href="#ND">North Dakota</a></li>
            <li><a href="#OH">Ohio</a></li>
            <li><a href="#OK">Oklahoma</a></li>
            <li><a href="#OR">Oregon</a></li>
            <li><a href="#PA">Pennsylvania</a></li>
            <li><a href="#RI">Rhode Island</a></li>
            <li><a href="#SC">South Carolina</a></li>
            <li><a href="#SD">South Dakota</a></li>
            <li><a href="#TN">Tennessee</a></li>
            <li><a href="#TX">Texas</a></li>
            <li><a href="#UT">Utah</a></li>
            <li><a href="#VT">Vermont</a></li>
            <li><a href="#VA">Virginia</a></li>
            <li><a href="#WA">Washington</a></li>
            <li><a href="#WV">West Virginia</a></li>
            <li><a href="#WI">Wisconsin</a></li>
            <li><a href="#WY">Wyoming</a></li>
        </ul>
        <script type="text/javascript">
            function empty(mixed_var) {
                var undef, key, i, len;
                var emptyValues = [undef, null, false, 0, '', '0'];
                for (i = 0, len = emptyValues.length; i < len; i++) {
                    if (mixed_var === emptyValues[i]) {
                        return true;
                    }
                }
                if (typeof mixed_var === 'object') {
                    for (key in mixed_var) {
                        return false;
                    }
                    return true;
                }
                return false;
            }
            function isset() {
                var a = arguments, l = a.length, i = 0, undef;
                if (l === 0) {
                    throw new Error('Empty isset');
                }
                while (i !== l) {
                    if (a[i] === undef || a[i] === null) {
                        return false;
                    }
                    i++;
                }
                return true;
            }
            var ulToSelect = function(element, edgeWidth) {
                var $currentId = undefined;
                var closed = false;
                var adSelect = function() {
                    var $thisUl = element; 
                    $thisUl.addClass("ul-select");
                    $thisUl.hide();
                    var $activeLi = $thisUl.find("li.active");
                    if($activeLi.length > 0) {
                        $activeLi.addClass("hover");
                        var $div = $(document.createElement('div')).attr({
                            "class": "ul-selector",
                            "id": $thisUl.attr("id")
                        }).append($(document.createElement('a')).attr({
                            "href": "#"
                        }).text($activeLi.find("a").text()));
                        $thisUl.before($div);
                    }
                    else {
                        var $firstLi = $thisUl.find("li:first");
                        if($firstLi.length > 0) {
                            $firstLi.attr({
                                "class": "active"
                            });
                            var $div = $(document.createElement('div')).attr({
                                "class": "ul-selector",
                                "id": $thisUl.attr("id")
                            }).append($(document.createElement('a')).attr({
                                "href": "#"
                            }).text($firstLi.find("a").text()));
                            $thisUl.before($div);
                        }
                    }
                    if($thisUl.hasClass("ul-select")) {
                        var $divSearch = $(document.createElement('div')).attr({
                            "class": "ul-selector-search",
                            "id": $thisUl.attr("id")
                        }).append($(document.createElement('input')).attr({
                            "type": "text"
                        }));
                        $thisUl.before($divSearch);
                    }
                };
                var close = function() {
                    closed = true;
                    if($("ul#" + $currentId).hasClass("ul-select")) {
                        $("ul#" + $currentId).hide();
                        $("div.ul-selector-search#" + $currentId).find("input").val("");
                        $("div.ul-selector-search#" + $currentId).hide();
                        $("ul#" + $currentId).find("li").each(function(){
                            $(this).show();
                            if($(this).hasClass("active")) {
                                $(this).addClass("hover");
                            }
                        });
                    }
                };
                var sentinel = function() {
                    var $thisUl = element;
                    $("div.ul-selector#" + $currentId).click(function(event){
                        event.preventDefault();
                        closed = false;
                        if(!($("ul#" + $currentId).is(":visible"))) {
                            $("ul#" + $currentId).show();
                            $("div.ul-selector-search#" + $currentId).show();
                            $("ul#" + $currentId).css({
                                "border-bottom": "1px solid #ccc", 
                                "border-right": "1px solid #ccc",
                                "border-left": "1px solid #ccc"});
                        } else {
                            close();
                        }
                    });
                    $($thisUl).find("li").click(function(event){
                        $thisUl.find("li").each(function(){
                            $(this).removeClass("active");
                        });
                        $(this).addClass("active");
                        var $activeText = $(this).find("a").text();
                        $("div.ul-selector#" + $currentId + "> a").text($activeText);
                        close();
                    });
                    $thisUl.find("li").hover(function(){
                        if(closed === false) {
                            $thisUl.find("li").removeClass("hover");
                        }
                    });
                };
                var reconnaissance = function() {
                    $(document).click(function(event) {
                        if(!$(event.target).is("div.ul-selector#" + $currentId + "> a") && !$(event.target).is("div.ul-selector-search#" + $currentId + "> input")) {
                            close();
                        }
                    });
                };
                var search = function () {
                    var $thisUl = element;
                    var showHideLis = function (text) {
                        $thisUl.find("li").each(function(index, element) {
                            $(element).show();
                        });
                        $thisUl.find("li").each(function(index, element) {
                            if(!($(element).data("text").toLowerCase()).includes(text.toLowerCase())) {
                                $(element).hide();
                            }
                        });
                    };
                    $thisUl.find("li").each(function(index, element) {
                        $(element).attr({
                            "data-text": $(element).find("a").text()
                        });
                    });
                    $("div.ul-selector-search#" + $thisUl.attr("id") + " input").keyup(function(event) {
                        showHideLis(this.value);
                    }).keydown(function(event) {
                        if(event.which === 13) {
                            event.preventDefault();
                            var $visibleLi = $thisUl.find("li:visible:first");
                            if(isset($visibleLi)) {
                                window.location.href = $visibleLi.find("a").attr('href');
                                $thisUl.find("li").each(function(){
                                    $(this).removeClass("active");
                                });
                                $visibleLi.addClass("active");
                                var $activeText = $visibleLi.find("a").text();
                                $("div.ul-selector#" + $currentId + "> a").text($activeText);
                                close();
                            }
                        }
                    });
                };
                if($(window).width() <= edgeWidth) {
                    if(!$(element).hasClass("ul-select")) {
                        $currentId = $(element).attr("id");
                        adSelect();
                        close();
                        sentinel();
                        reconnaissance();
                        search();
                    }
                } else if($(element).hasClass("ul-select")){
                    $(element).css("border", "none");
                    $(element).removeClass("ul-select");
                    $("div.ul-selector").remove();
                    $("div.ul-selector-search").remove();
                    $(element).show();
                }
            };
            
            $(window).load(function() {
                ulToSelect($("ul#usa"), 767);
                ulToSelect($("ul#eu"), 767);
            }).resize(function() {
                ulToSelect($("ul#usa"), 767);
                ulToSelect($("ul#eu"), 767);
            });
        </script>
    </body>
</html>
