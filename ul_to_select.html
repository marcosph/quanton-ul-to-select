<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>jQuery Piu/Meno Text</title>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <style>
            ul.ul-select { 
                width: auto;
                margin: 8px auto;
                padding: 0px;
                border: 1px solid #ccc;
                list-style:none;
                background-image: url("./down-arrow-black.png");
                background-size: 16px 16px;
                background-repeat: no-repeat;
                background-attachment: scroll;
                background-position: calc(100% - 8px) 8px;
                background-color: transparent;
                cursor: pointer;
                line-height: 2rem;
                font-family: sans-serif;
            }
            ul.ul-select li.active a, ul.ul-select li.visible a { 
                color: #000;
            }
            ul.ul-select li.hover {
                background-color: #666;
            }
            ul.ul-select li.hover a {
                color: #fff;
            }
            ul.ul-select li a {
                margin-left: 8px;
                padding-left: 8px;
                margin-right: 8px;
                display: block;
                color: #888;
                text-decoration:none;
            }
            ul.ul-select li:active, ul.ul-select li:hover {
                background-color: #666;
            }
            ul.ul-select li:active a, ul.ul-select li:hover a {
                color: #fff;
            }
            ul.ul-select li.visible:active, ul.ul-select li.visible:hover {
                background-color: transparent;
            }
            ul.ul-select li.visible:active a, ul.ul-select li.visible:hover a {
                color: #000;
            }
        </style>
    </head>
    <body>
        <ul id="first">
            <li><a href="./ul_to_select.php#fist-option1">Option 1</a></li>
            <li><a href="./ul_to_select.php#fist-option2">Option 2</a></li>
            <li><a href="./ul_to_select.php#fist-option3">Option 3</a></li>
        </ul>
        <ul id="second">
            <li><a href="./ul_to_select.php#second-option1">Option 1</a></li>
            <li class="active"><a href="./ul_to_select.php#second-option2">Option 2</a></li>
            <li><a href="./ul_to_select.php#second-option3">Option 3</a></li>
            <li><a href="./ul_to_select.php#second-option4">Option 4</a></li>
            <li><a href="./ul_to_select.php#second-option5">Option 5</a></li>
            <li><a href="./ul_to_select.php#second-option6">Option 6</a></li>
            <li><a href="./ul_to_select.php#second-option7">Option 7</a></li>
            <li><a href="./ul_to_select.php#second-option8">Option 8</a></li>
            <li><a href="./ul_to_select.php#second-option9">Option 9</a></li>
            <li><a href="./ul_to_select.php#second-option10">Option 10</a></li>
            <li><a href="./ul_to_select.php#second-option11">Option 11</a></li>
            <li><a href="./ul_to_select.php#second-option12">Option 12</a></li>
        </ul>
        <ul id="third">
            <li><a href="./ul_to_select.php#third-option1">Option 1</a></li>
            <li><a href="./ul_to_select.php#third-option2">Option 2</a></li>
            <li class="active"><a href="./ul_to_select.php#third-option3">Option 3</a></li>
        </ul>
        <script type="text/javascript">
            $(function(){
                var ulToSelect = function(element, edgeWidth) {
                    var closed = false;
                    var adSelect = function() {
                        var $thisUl = element; 
                        $thisUl.addClass("ul-select");
                        var $activeLi = $thisUl.find("li.active");
                        if($activeLi.length > 0) {
                            $activeLi.addClass("hover");
                            var $li = $(document.createElement('li')).attr({
                                    "class": "visible"
                            }).append($(document.createElement('a')).attr({
                                "href": "#"
                            }).text($activeLi.find("a").text()));
                            $thisUl.prepend($li);
                        }
                        else {
                            var $firstLi = $thisUl.find("li:first");
                            if($firstLi.length > 0) {
                                $firstLi.attr({
                                    "class": "active"
                                });
                                var $li = $(document.createElement('li')).attr({
                                    "class": "visible"
                                }).append($(document.createElement('a')).attr({
                                    "href": "#"
                                }).text($firstLi.find("a").text()));
                                $thisUl.prepend($li);
                            }
                        }
                    };
                    var close = function() {
                        closed = true;
                        var $thisUl = element;    
                        if($thisUl.hasClass("ul-select")) {
                            $thisUl.find("li:not(.visible)").hide();
                            $thisUl.find("li.visible").show().css("border-bottom", "none");
                            $thisUl.find("li").each(function(){
                                if($(this).hasClass("active")) {
                                    $(this).addClass("hover");
                                }
                            });
                        }
                    };
                    var sentinel = function() {
                        var $thisUl = element;
                        $($thisUl).find("li").click(function(event){
                            if($(this).is('li.visible')) {
                                event.preventDefault();
                                closed = false;
                                if(!$thisUl.find("li:nth-child(2)").is(":visible")) {
                                    $thisUl.find("li").show();
                                    $(this).css("border-bottom", "1px solid #ccc");
                                } else {
                                    close();
                                }
                            }
                            else {
                                $thisUl.find("li").each(function(){
                                    $(this).removeClass("active");
                                });
                                $(this).addClass("active");
                                var $activeText = $(this).find("a").text();
                                $thisUl.find("li.visible").each(function(){
                                    $(this).find("a").text($activeText);
                                    $(this).css("border-bottom", "1px solid #ccc");
                                });
                                close();
                            }
                        });
                        $thisUl.find("li:not(.visible)").hover(function(){
                            if(closed === false) {
                                $thisUl.find("li").removeClass("hover");
                            }
                        });
                    };
                    var reconnaissance = function() {
                        $(document).click(function(event) {
                            if(!$(event.target).is('li a')) {
                                close();
                            }
                        });
                    };
                    if($(window).width() <= edgeWidth) {
                        if(!$(element).hasClass("ul-select")) {
                            adSelect();
                            close();
                            sentinel();
                            reconnaissance();
                        }
                    } else if($(element).hasClass("ul-select")){
                        $(element).removeClass("ul-select");
                        $(element).find("li.visible").remove();
                        $(element).find("li").each(function(){
                            $(this).show();
                        });
                    }
                };
                
                $(window).resize(function() {
                    ulToSelect($("ul#first"), 767);
                    ulToSelect($("ul#second"), 767);
//                  ulToSelect($("ul#third"), 767);
                });
                
                ulToSelect($("ul#first"), 767);
                ulToSelect($("ul#second"), 767);
//                ulToSelect($("ul#third"), 767);
            });
        </script>
    </body>
</html>
